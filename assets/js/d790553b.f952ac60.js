"use strict";(self.webpackChunkawesome_ha_blueprints_website=self.webpackChunkawesome_ha_blueprints_website||[]).push([[574],{4480:(e,r,n)=>{n.d(r,{Dk:()=>l,PG:()=>c});var t=n(8791),o=n(4784);let i=null;const a=()=>{if(i)return i;const e=(o.default?.customFields||{}).env||{},r=e.SUPABASE_URL,n=e.SUPABASE_ANON_KEY;return r&&n&&s({supabaseUrl:r,supabaseKey:n}),i},s=e=>{let{supabaseUrl:r,supabaseKey:n}=e;i=(0,t.UU)(r,n),console.log("Supabase initialized")},l=async function(e,r,n){if(void 0===n&&(n="latest"),!a())return console.error("Supabase client not initialized"),!1;try{const{error:t}=await i.from("blueprint_downloads").insert([{blueprint_category:e,blueprint_id:r,blueprint_version:n,download_date:(new Date).toISOString()}]);return!t||(console.error("Error recording blueprint download:",t),!1)}catch(t){return console.error("Exception recording blueprint download:",t),!1}},c=async(e,r)=>{if(!a())return console.error("Supabase client not initialized"),0;try{const{data:n,error:t}=await i.rpc("get_blueprint_downloads",{p_category:e,p_id:r});return t?(console.error("Error getting blueprint downloads via RPC:",t),0):"number"==typeof n?n:0}catch(n){return console.error("Exception getting blueprint downloads:",n),0}}},6428:(e,r,n)=>{n.r(r),n.d(r,{default:()=>c});var t=n(8225),o=n(6902),i=n(5985),a=n(913),s=n(4480),l=n(7557);function c(e){const r=e.route.category,n=e.route.id,{consent:c}=(0,i.S)(),d=(()=>{if("undefined"!=typeof window){return new URLSearchParams(window.location.search).get("version")||"latest"}return"latest"})(),u=`https://my.home-assistant.io/redirect/blueprint_import/?blueprint_url=${encodeURIComponent(`https://raw.githubusercontent.com/EPMatt/awesome-ha-blueprints/main/blueprints/${r}/${n}/${n}.yaml`)}`;return(0,t.useEffect)((()=>{c&&(0,a.sx)("blueprint","download",`${r}/${n}`,void 0),(0,s.Dk)(r,n,d).then((e=>{e||console.error("Failed to record blueprint download in database")})).catch((e=>{console.error("Error recording blueprint download:",e)})),window.location.href=u}),[c,r,n,d,u]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.A,{children:(0,l.jsxs)("title",{children:["Download ",r,"/",n]})}),(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",fontSize:"20px"},children:[(0,l.jsx)("h1",{children:"Thanks for downloading!"}),(0,l.jsx)("p",{children:"Redirecting to your Home Assistant instance..."})]})]})}}}]);